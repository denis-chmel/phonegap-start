/*! Compiled on: Thu May 21 2015 08:13:23 */
var fileVersion = "v1.0-4-f842d9e-dirty"; 
"use strict";define(["modules/app"],function(app){app.factoryManager("$select",["$animate","$rootScope",function($animate,$rootScope){var $select=function(config){this.$element=config.$element,this.$scope=config.$scope,this.options=[];var select=this;angular.element(window).bind("click",function(e){var elements=$(e.target).parents(),close=!0;if(select.$element.hasClass("open")){for(var i=0;i<elements.length;i++)elements[i]==select.$element[0]&&(close=!1);close&&select.close()}})};return $select.prototype={constructor:$select,opened:!1,open:function(){if(!this.$element.hasClass("open")){this.opened=!0,$animate.addClass(this.$element,"open");var windowHeight=$(window).height(),selectTop=this.$element.offset().top-$(window).scrollTop(),selectMaxHeight=Math.max(250,windowHeight-selectTop-50);this.$element.find("ul").css({maxHeight:selectMaxHeight})}},close:function(){this.$element.hasClass("open")&&(this.opened=!1,$animate.removeClass(this.$element,"open"))},isOpen:function(){return this.opened},setModel:function(model){this.$model=model},addOption:function(option){this.options.push(option)},getOption:function(key){for(var i=0;i<this.options.length;i++)if(this.options[i].value===key)return this.options[i];return null},select:function(value){if(value!=this.$model.$modelValue){var option=this.getOption(value),model=this.$model;this.$scope.title=option.title,this.$scope.value=option.value,$rootScope[this.$model.$name]=option.value,model.$setViewValue($rootScope[model.$name]||null),this.$scope.$$phase||this.$scope.$apply()}}},$select}]),app.directiveManager("fancySelect",["$rootScope","$select","$filter",function($rootScope,$select,$filter){return{restrict:"A",templateUrl:"/release/html/directives/fancySelect/select.html",replace:!0,transclude:!0,require:"ngModel",controller:function($scope,$element,$attrs){var ctrl=this;return $scope.select=new $select({$element:$element,$scope:$scope}),ctrl.select=$scope.select,ctrl.scope=$scope,ctrl.model=$scope.ngModel,$attrs.multiple&&(ctrl.multiple=!0),$element.bind("click",function(){$element.hasClass("disabled")||($scope.select.isOpen()?$attrs.multiple||$scope.select.close():$scope.select.open())}),ctrl},scope:{name:"@",filter:"@",fancyDefault:"@",ngModel:"="},link:function($scope,$element,attrs,model){$scope.title=$scope.filter?$scope.fancyDefault?$filter($scope.filter)($scope.fancyDefault):"Select":$scope.fancyDefault?$scope.fancyDefault:"Select",$scope.$watch("fancyDefault",function(title){title&&($scope.title=$scope.filter?$filter($scope.filter)(title):title)}),$scope.select.setModel(model),$element.append('<input type="hidden" name="'+$scope.name+'" ng-model="ngModel">')}}}]),app.directiveManager("fancyOption",["$select","$timeout","$rootScope",function($select,$timeout){return{restrict:"A",templateUrl:"/release/html/directives/fancySelect/option.html",require:"^fancySelect",replace:!0,transclude:!0,scope:{value:"@",ngSelected:"@",isOptionGrayed:"@"},link:function($scope,$element,attr,ctrl){ctrl.scope.$watch("ctrl.model",function(){$scope.value==ctrl.scope.ngModel&&(ctrl.scope.value=$scope.value)}),$timeout(function(){ctrl.select.addOption({title:$element.html(),value:$scope.value}),$scope.isOptionGrayed=!("true"!=$scope.isOptionGrayed),$scope.ngSelected=!("true"!=$scope.ngSelected),$element.bind("click",function(e){ctrl.multiple?($scope.ngSelected=$scope.ngSelected?!1:!0,$scope.$apply()):(ctrl.select.select($scope.value),ctrl.select.close(),e.stopPropagation())})})}}}])});