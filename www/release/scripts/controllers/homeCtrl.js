/*! Compiled on: Thu May 21 2015 09:01:07 */
var fileVersion = "v1.0-4-f842d9e-dirty"; 
"use strict";define(["modules/app","welcomeTour","mixpanelFactory","authenticationFactory"],function(app){app.controller("homeCtrl",["$scope","$rootScope","$state","$modal","mixpanelFactory","$loading","authenticationFactory","$error","$timeout","$sce",function($scope,$rootScope,$state,$modal,mixpanelFactory,$loading,authenticationFactory,$error,$timeout,$sce){$scope.submitted=!1,$scope.params={},mixpanelFactory.track($state.current.data.mixpanel_title+" Visit"),$(window).bind("resize onorientationchange",function(){$timeout(function(){$scope.params.map_top=-(1601-$(window).height())/2})}).resize(),$scope.params.map_url=$sce.trustAsResourceUrl("https://www.google.com/maps/embed/v1/place?key=AIzaSyB70RW4l7CERbOLPANGY2_sKEphyluBXOk&zoom=13&q=40.711496,-74.012224"),navigator.geolocation?navigator.geolocation.getCurrentPosition(function(position){$timeout(function(){var map_url="https://www.google.com/maps/embed/v1/place?key=AIzaSyB70RW4l7CERbOLPANGY2_sKEphyluBXOk&zoom=14&q="+position.coords.latitude+","+position.coords.longitude;$scope.params.map_url=$sce.trustAsResourceUrl(map_url)})}):console.error("Geolocation is not supported by this browser."),$scope.facebookAuthenticate=function(){},$scope.showIntro=function(){$modal.open({templateUrl:"/release/html/modals/intro.html",windowClass:"home-intro"})},$rootScope.signinmodal=function(){$modal.open({windowClass:"fullscreen signin",templateUrl:"/release/html/modals/account/signin.html"})},$rootScope.signupmodal=function(){$modal.open({windowClass:"fullscreen signup",templateUrl:"/release/html/modals/account/signup.html"})},$scope.signUp=function(){return $scope.submitted=!0,this.signUpForm.$invalid?void $error.alert(null,"Please complete all fields"):($loading.start(),void authenticationFactory.signUp({email:this.email,password:this.password,first_name:this.first_name,last_name:this.last_name}).finally(function(){$loading.end()}))},$timeout(function(){$scope.login_message&&($("#signin-form:visible").length?$rootScope.login_now_tour=!0:$scope.signinmodal())})}])});