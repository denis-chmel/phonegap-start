/*! Compiled on: Thu May 21 2015 08:13:23 */
var fileVersion = "v1.0-4-f842d9e-dirty"; 
"use strict";define(["modules/app","dietsFactory","usersFactory","checkbox","authenticationFactory","mixpanelFactory"],function(app){app.controllerManager("dietsCtrl",["$scope","$rootScope","$timeout","$state","usersFactory","dietsFactory","authenticationFactory","$beacon","mixpanelFactory","$loading",function($scope,$rootScope,$timeout,$state,usersFactory,dietsFactory,authenticationFactory,$beacon,mixpanelFactory,$loading){mixpanelFactory.track("Goals viewed in signup"),$beacon.on("authentication.change",function(){$scope.diets=null}),dietsFactory.getAll($rootScope.user).then(function(diets){$scope.diets=diets.map(function(diet){return diet.id&&$rootScope.preselectedDiet==diet.id&&(diet.checked=!0),diet})}),$scope.dietClicked=function(){$timeout(function(){$scope.submit()})},$scope.submit=function(){var i,diets=[];for(i=0;i<this.diets.length;i++)this.diets[i].checked&&diets.push(this.diets[i].id);$loading.start(!0),angular.extend($rootScope.session.mixpanel_properties,{Diets:JSON.stringify(diets)}),usersFactory.update({diets:diets}).then(function(){$state.transitionTo("primary.tastes")})}}])});