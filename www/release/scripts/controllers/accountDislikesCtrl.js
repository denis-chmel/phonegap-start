/*! Compiled on: Thu May 21 2015 08:13:23 */
var fileVersion = "v1.0-4-f842d9e-dirty"; 
"use strict";define(["modules/app","dishesFactory","iCheck"],function(app){app.controllerManager("accountDislikesCtrl",["$scope","dishesFactory","$loading","usersFactory","$state","$error",function($scope,dishesFactory,$loading,usersFactory,$state,$error){$scope.keywords=[],$scope.restaurants=[],$scope.cuisines=[],$scope.data={limit:5,show_all_disliked:!1,disliked:[]};var makeCheckboxReady=function(list){var result=[];return angular.forEach(list,function(value,i){var item;item="object"==typeof value?value:{id:i,text:value},item.checked=!0,result.push(item)}),result},success_message="Changes Saved.";$scope.toggleDislike=function(dish,silent){dish.loading=!0,dishesFactory.rate(dish,dish.checked?"dislike":"neutral").then(function(){silent||$error.success(null,success_message,15e3,function(){dish.checked=!dish.checked,$scope.toggleDislike(dish,!0)}),dish.loading=!1})},$loading.start(),dishesFactory.getDisliked().then(function(dishes){$scope.data.disliked=makeCheckboxReady(dishes),$loading.end()}),$scope.keywords=makeCheckboxReady($scope.user.dislike_keywords),$scope.restaurants=makeCheckboxReady($scope.user.dislike_restaurants),$scope.cuisines=makeCheckboxReady($scope.user.dislike_cuisines),$scope.submit=function(item,silent){item.loading=!0,usersFactory.update({disliked_keywords:$scope.keywords,disliked_cuisines:$scope.cuisines,disliked_restaurants:$scope.restaurants}).then(function(){silent||$error.success(null,success_message,15e3,function(){item.checked=!item.checked,$scope.submit(item,!0)}),item.loading=!1})}}])});