/*! Compiled on: Thu May 21 2015 08:13:23 */
var fileVersion = "v1.0-4-f842d9e-dirty"; 
"use strict";define(["modules/app","cardsFactory"],function(app){app.controllerManager("accountEditCardCtrl",["$scope","$rootScope","cardsFactory","$modalInstance","item","$location","$error","$loading",function($scope,$rootScope,cardsFactory,$modalInstance,item,$location,$error,$loading){item&&!item.label&&(item.label=item.display_label),$scope.item=item||{unlocked:!0},$scope.unlockNumber=function(item){item.card_number="",item.unlocked=!0,$(".card-number input").focus()},$scope.submit=function(){if(this.submitted=!0,this.editForm.$invalid)return void $error.alert(null,"Please fix errors in highlighted fields");var expire=this.item.expiration.match(/.{1,2}/g),expire_month=expire[0],expire_year=expire[1],card={id:this.item.id,label:this.item.label,card_number:this.item.card_number,expiration:this.item.expiration,expire_month:expire_month,expire_year:expire_year,full_name:this.item.full_name,zip:this.item.zip};$loading.start(),cardsFactory.save(card).then(function(){$error.success(null,"Card was successfully saved"),$modalInstance.close()},function(response){$loading.end(),$error.alert(null,response.data.data||response.data.error.message)})}}])});